---
layout: post
title:  "Inside Linux Mining malware "
by:     "Michael Meade"
---

<meta name="keywords" content="xmr linux malware, monero miner" />

## Script Information
I was searching through hybrid-analysis.com and I stumbled on to a bash script that looked like it's being used for deploying mining scripts on Linux machines.
<br>

![Octocat](https://i.imgur.com/pvtH2iu.png =100x20)

From what I understand from Bash, the script creates a function called ```Check()``` that will download the other files. Check() has two argurments, I labled the arguments <b><font color="red">1</font></b> and <b><font color="blue">2</font></b>.
<br>
<br>
The first argument <font color="red"><b>1,</b></font> is the url where the script is hosted. The second argument <font color="blue"><b>2,</b></font> is the name of the directory that it will download the payload to. 
<br><br>
The first file that the scripts downloads is: ```http://132.148.148.79/plus/kok```. The downloaded script will check and remove any other competing miners. The script checks if there are any matching strings in the cronjob and uses the grep command to check for any other strings in the running proccess. It wil then kill the processes. 
<br>
<br>
The second url in the first script will download a script from ```http://132.148.148.79/plus/wow```. Once this script is ran it  will download the script from ```https://pastebin.com/raw/zwJ7M9et```. The attackers base64 encoded the script to protect it from being analyazed. 
The deobfuscated script looks like this: <br>

![Octocat](https://i.imgur.com/esGa2VS.png =100x20)
<br>
<br>

THe scripts downloads the final payload from ```http://132.148.148.79/plus/rc7```.
![Octocat](https://i.imgur.com/JaHI09x.png=100x20)
<br><br>
I installed the script on my subsystem so it might be a little different than a pure Linux box. 
The script downloads a bunch of files to the ```/tmp/.dbb``` directory. 

## Pool and Address Info
The Attackers are using the open source miner  ```xmr-stak```.   

![Octocat](https://i.imgur.com/2ee97aq.png =100x20)

![Octocat](https://i.imgur.com/4N9h0iu.png =100x20)
Looks like they are using MineXmr.com as the mining pool.
At the time of the writing the attackers have only made $110.33. From the data available on minexmr.com they started to mine on Jan 3 2019. 
Xmrhunter.com is a site that scrapes a bunch of different mining pools. It allows users to enter a xmr address and the site will return the amount that the address has mined. According to the xmrhunter the people behind this mining campaign also used the mining pool dwarfpool. They only made $0.02 on this pool and was last seen January 14, 2019. They were never paid for the $0.02 they mined.


## ICO
<b>IPs || Sites</b><br>
&nbsp;&nbsp;&nbsp;&nbsp;hxxp://132.148.148.79<br>
&nbsp;&nbsp;&nbsp;&nbsp;hxxp://pastebin.com/raw/zwJ7M9et<br>
&nbsp;&nbsp;&nbsp;&nbsp;hxxp://minexmr.com<br>
&nbsp;&nbsp;&nbsp;&nbsp;hxxp://139.99.120.75:443<br>
&nbsp;&nbsp;&nbsp;&nbsp;hxxp://139.224.20.173<br>
<br><b>XMR address</b><br>
&nbsp;&nbsp;&nbsp;&nbsp;4Ak4rRJHzo4SsxQWRcMGJpBRKCokRVRGc5v599tJhQBSczmvXRBAmWETEDX8xYhwUhAVZCCupHULDJFPNrmb9AErLtZfEaK<br>
<br><b>Hashes</b><br>
&nbsp;&nbsp;&nbsp;&nbsp;SHA1 e09e9b2d8fbd25b8129c0577eeba82d3eb783415 e081a4181e27091fff558dc9ed3f7be.sh<br>
&nbsp;&nbsp;&nbsp;&nbsp;SHA1 ebf60b6e4ca6a3d7c59b4f950d58196a69412b05 kok<br>
&nbsp;&nbsp;&nbsp;&nbsp;SHA1 1eb6978d0e463248ad36f6ce8da7b13b488e5260 nx.2.sh<br>
&nbsp;&nbsp;&nbsp;&nbsp;SHA1 8ffc58caa11dd7efedf0d4fb655231a99a10cf20 wow<br>
&nbsp;&nbsp;&nbsp;&nbsp;SHA1 59e96f96ecd1af0745eb705a4545bf0eb3f69028 zwJ7M9et<br>
&nbsp;&nbsp;&nbsp;&nbsp;SHA1 82433c8374a954a7daa7fbdb9e35e346dbd78bd3 nx<br> 
&nbsp;&nbsp;&nbsp;&nbsp;SHA1 dcfbdb2fe2f0d29c213e23b6b10e9da813bae9d3 rc7<br>
<br><b>AV</b><br>
&nbsp;&nbsp;&nbsp;&nbsp;hxxps:/hybrid-analysis.com/sample/2e2c93911f787a72422d41d7c8858a073e081a4181e27091fff558dc9ed3f7be<br>
